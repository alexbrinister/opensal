<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="4" MadCap:lastHeight="3269" MadCap:lastWidth="600" MadCap:disableMasterStylesheet="true" MadCap:tocPath="About Resampling" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:liveHelp="MDUn+I5jEGHnh+kZfwmRTcp45eQsA0pyG4p/xgXm2ndIQfBpY4OpdvsQezdIV2nKWn3HFiAWLdCLgF3oKsLb/yj4+MLV0w7AX61KWnnX/dw0PWaJnu4+4m3gE0oxaAT1hATqF2YQlxy6R9vajdjw8R+xbEunJXKkJQIt+siV7xmqng4nJ1TQz7eBR7q6Ya9t8yEao1m2Gh7xnZQzhDIwDPGFZR2iDC7qxHCFBINeqfBG7OKinYT8UwHpQAtEEAR9OhyGrblaWmSFCt+FXZUrn+4VkI8nYhtqAK8VIWPweQk28uuaxuG0gXSrBB/UaXFkvFYgVu1IvOxrt781fB9oppmpmDDG/8PwJSG6+Pj3G+TCVfe5lrvs6DScH5S5qYlaTfiuhpeKKs8nab4T6JTqJKXidzyTYPe1pw0sm827T6UVzS2Uvag7A6Tulcj9W9V07fm6IxBunW/WzjanyssESX0kbxNXeFKle5SL/667rkkxOsL0L8jkpoWktWI+CDQdMwjcaAy434bciLtJjMe8fsHyyTLCzMlSlCse7VBG0ravgl4xukGapefpQFTxwsj4aBt2s2UbaeAe+EnRCYWp2CjHRyekeD+DQr55TdI9UWOBBishd3iL5W1yl3WRPYiCg0/2hYOjp5+ckmc4fDC2ffLmuC8SkjdRN38IvTgdAmBBskYRsbEW/1fUVZKPCvy4nJo3bqzFtKVV6JT/ws+vv1YfbnFbSuYc/LXinVADcOfViUO9/e0Uw7H4RP4stv5/UnIuIeEwi8xHPjN254j7oqVpT8jdVRTafMJGo8M5U/yDHXQ7oOo8MBMp36azpBDb0KXISu0bX96LGxLWUQxWsXGYPR6soJ5VAV2VAgs6Dh7eO+qZ36AzFl1iQTMGq+z0wi83670PiCTh81AVKhHHOdKP7ruCLb2TO33hShvpVXbzTJx6koaGOvdjBYo5yvN1J1R5ZHym/wFSIfLqnqmU468OKZr1aVP8Ckem+jLVuMi8L2PadfxrmGs8isY+00vM" MadCap:PathToHelpSystem="../../" MadCap:HelpSystemFileName="Default.xml" MadCap:SearchType="Stem">
    <head>
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" type="text/css" /><title>Functional Overview and Design Considerations</title>
        <link href="../Resources/TableStyles/o_Note.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/o_Basic.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/p_Note.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/p_Basic.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/p_Note.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/Stylesheets/BookStyles.css" rel="stylesheet" type="text/css" />
        <script src="../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapLiveHelpUtilities.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapLiveHelpBody.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapAddCommentDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapReplyCommentDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapRegisterUserDialog.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../Default_CSH.htm#CH05 - Resampling/Considerations.htm" style="">Open topic with navigation</a>
        </p>
        <h1 style="page-break-after: auto;page-break-before: always;"><a name="kanchor98"></a>Functional Overview and Design Considerations</h1>
        <p class="Body">SAL uses a hierarchical design strategy that allows you to improve performance by separating setup and inner loop routines, as shown in.</p>
        <p class="CaptionNumChap_Table" MadCap:autonum="&lt;b&gt;Table 4-1: &lt;/b&gt;"><span class="autonumber"><span><b>Table 4-1: </b></span></span>Hierarchical Design of Resampling Routines</p>
        <table style="caption-side: top;width: 500px;mc-table-style: url('../Resources/TableStyles/o_Basic.css');" class="TableStyle_o_Basic" cellspacing="0">
            <col style="width: 204px;" />
            <col style="width: 116px;" />
            <col />
            <col />
            <thead>
                <tr>
                    <th class="TableStyle_o_Basic_Head_0_0_RowSep_ColSep">Function Group</th>
                    <th class="TableStyle_o_Basic_Head_0_0_RowSep_ColSep">Calling Frequency</th>
                    <th class="TableStyle_o_Basic_Head_0_0_RowSep_ColSep">Created Object</th>
                    <th class="TableStyle_o_Basic_Head_0_0_RowSep_ColEnd">Object Reusability</th>
                </tr>
            </thead>
            <tr>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColSep">
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_filter_close">resamp_filter_close()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_filter_create">resamp_filter_create()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_filter_create_user_alloc">resamp_filter_create_user_alloc()</a>
                    </p>
                    <p><a href="Resampling_functions.htm#resamp_make_filter_set">resamp_make_filter_set()</a>
                    </p>
                </td>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColSep">At the setup and closing stages only</td>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColSep">filter</td>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColEnd">Highest</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColSep">
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_map_close">resamp_map_close()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_map_create">resamp_map_create()</a>
                    </p>
                    <p style="margin-bottom: 3pt;"><a href="Resampling_functions.htm#resamp_map_create_user_alloc">resamp_map_create_user_alloc()</a>
                    </p>
                </td>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColSep">To build and reuse maps</td>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColSep">reference map</td>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColEnd">High</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColSep">
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_ricx">resamp_ricx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_cicx">resamp_cicx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_zicx">resamp_zicx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_mc_ricx">resamp_mc_ricx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_mc_cicx">resamp_mc_cicx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_mc_zicx">resamp_mc_zicx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_mr_ricx">resamp_mr_ricx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_mr_cicx">resamp_mr_cicx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_mr_zicx">resamp_mr_zicx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_rocx">resamp_rocx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_cocx">resamp_cocx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_zocx">resamp_zocx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_mc_rocx">resamp_mc_rocx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_mc_cocx">resamp_mc_cocx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_mc_zocx">resamp_mc_zocx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_mr_rocx">resamp_mr_rocx()</a>
                    </p>
                    <p style="margin-bottom: 2pt;"><a href="Resampling_functions.htm#resamp_mr_cocx">resamp_mr_cocx()</a>
                    </p>
                    <p><a href="Resampling_functions.htm#resamp_mr_zocx">resamp_mr_zocx()</a>
                    </p>
                </td>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColSep">Inner loops</td>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColSep">N/A</td>
                <td class="TableStyle_o_Basic_Body_0_0_RowSep_ColEnd">N/A</td>
            </tr>
        </table>
        <p class="Body">You can use the <a href="Resampling_functions.htm#resamp_make_filter_set">resamp_make_filter_set()</a> routine to construct a polyphase filter set that inputs to the <a href="Resampling_functions.htm#resamp_filter_create">resamp_filter_create()</a> routine from a symmetric real-valued scalar filter function. The <a href="Resampling_functions.htm#resamp_make_filter_set">resamp_make_filter_set()</a> routine takes a pointer to the filter function as one of its arguments, along with the filter length and number of filters in the set. </p>
        <table style="width: 500px;caption-side: top;mc-table-style: url('../Resources/TableStyles/o_Note.css');" class="TableStyle_o_Note" cellspacing="0">
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_o_Note_Body_0_0_RowSep_ColEnd">
                        <p class="Note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #06347a;&quot; class=&quot;mcFormatColor&quot;&gt;Note&lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #06347a;" class="mcFormatColor">Note</span></b></span></span>&#160;</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_o_Note_Body_0_0_RowEnd_ColEnd">
                        <p>You can construct the input filter set manually. However, before you attempt this, Mercury strongly recommends that you review the code in <a href="Resampling_filter_sets.htm#Custom" target="" title="" alt="" class="MCXref_See_NoPrefix" MadCap:conditions="Default.ScreenOnly"><span style="color: DarkBlue;" class="mcFormatColor"><i>Custom Polyphase Filter Sets</i></span></a>.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p class="Body">The <a href="Resampling_functions.htm#resamp_filter_create">resamp_filter_create()</a> routine transforms a polyphase set of real-valued, equal length filters into a suitable internal representation. The routine allocates buffer space for this representation and returns a <code>filter_handle</code> to the filter object.</p>
        <p class="Body">The <a href="Resampling_functions.htm#resamp_filter_close">resamp_filter_close()</a> routine closes this object.</p>
        <table style="width: 500px;mc-table-style: url('../Resources/TableStyles/o_Note.css');" class="TableStyle_o_Note" cellspacing="0">
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_o_Note_Body_0_0_RowSep_ColEnd">
                        <p class="Note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #06347a;&quot; class=&quot;mcFormatColor&quot;&gt;Note&lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #06347a;" class="mcFormatColor">Note</span></b></span></span>&#160;</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_o_Note_Body_0_0_RowEnd_ColEnd">
                        <p>A given filter object (and any reference map object that is built from it) can be used only in the one resampling routine that matches the name specified in the <i>routine_name</i> parameter.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2><a name="Resampli"></a><a name="kanchor99"></a>Resampling Reference Maps</h2>
        <p class="Body">Next in the hierarchy is a reference map object <a href="Resampling_functions.htm#resamp_map_create">resamp_map_create()</a> create routine that transforms one or more reference map tables into a reference map object. The same polyphase filter set can be used with multiple map objects, and each reference map object can be used in multiple calls to the same resampling routine.</p>
        <p class="Body">The <a href="Resampling_functions.htm#resamp_map_create">resamp_map_create()</a> routine takes as a parameter the <code>filter_handle </code>returned by a prior call to the <a href="Resampling_functions.htm#resamp_filter_create">resamp_filter_create()</a> routine. The routine allocates buffer space for this internal representation and returns a <code>map_handle </code>to the map object.</p>
        <p class="Body">The <a href="Resampling_functions.htm#resamp_map_close">resamp_map_close()</a> routine closes this object.</p>
        <h3><a name="Boundary"></a><a name="kanchor100"></a>Boundary Handling</h3>
        <p class="Body">A reference map is considered out-of-bounds if the application of a complete m-point filter will extend past either end of the uniform sequence (see <a href="Terms.htm#top" target="" title="" alt="" class="MCXref_See_NoPrefix" MadCap:conditions="Default.ScreenOnly"><span style="color: DarkBlue;" class="mcFormatColor"><i>Resampling Terms and Definitions</i></span></a>). To be more precise, reference map values are considered in-bounds if the following formula is true:</p>
        <p class="Body1"><b>floor</b>((m–1)/2) &lt;= ref_map + (1/(2n)) &lt; N<sub>unif</sub> – <b>floor</b>(m/2)</p>
        <p class="Body1">where: 		</p>
        <p class="Body2">m = filter length</p>
        <p class="Body2">n = number of filters</p>
        <p class="Body2">N<sub>unif</sub> = uniform sequence length</p>
        <p class="Body">By extending the uniform sequence on one or both ends, you can achieve a variety of boundary handling options. For example, you can zero-extend the uniform sequence or extrapolate extra points (by replicating the nearest end-point).</p>
        <p class="Body">The <a href="Resampling_functions.htm#resamp_map_create">resamp_map_create()</a> routine takes a flag argument that determines how to handle out of bounds reference maps. By default, the resampling API does not perform boundary checking on the reference maps. These are assumed to  address valid m-point subsequences within the uniform sequence. It is your responsibility to guarantee that this condition is true.</p>
        <p class="Body">You can request boundary checking with two possible options for handling out of bounds reference maps:</p>
        <p class="Parameter">SAL_RESAMP_ZERO_OUT_OF_BOUNDS</p>
        <p class="Body1">The resampling routine effectively applies a filter of all zeros when a reference map is determined to be out-of-bounds. For OC routines, this causes a zero value to be written or added to the current output point. For IC routines, this leaves the output sequence unaltered for out-of-bounds maps.</p>
        <p class="Parameter">SAL_RESAMP_TAPER_OUT_OF_BOUNDS</p>
        <p class="Body1">An out-of-bounds reference map results in applying only the portion of the selected filter that coincides with valid points in the uniform sequence. Valid points have indexes that range from <span style="font-family: serif;">0</span> to N<sub>un</sub>–1, where N<sub>un</sub> is the length of the uniform sequence. The resampling calculation does not include filter coefficients that coincide <a name="kanchor101"></a>with points beyond either end of the uniform sequence.</p>
        <h3><a name="kanchor102"></a>Using Reference Mapping</h3>
        <p class="Body">Instead of invoking a separate call (and maintaining a separate map object) for each map table, you can make a single call to the <a href="Resampling_functions.htm#resamp_map_create">resamp_map_create()</a> routine to create and group a set of reference map tables. In all of the resampling routines, a map index parameter selects a particular table from the map object. So, when a unique reference map table is required for each row, you can construct a simple loop to resample a set of sequences stored as matrix rows.</p>
        <p class="Body">By invoking one of the multiple resampling routines, you can use a <i>single</i> reference map table repeatedly to resample multiple sequences. This approach allows a more efficient implementation than a simple loop over any of the single resampling routines. </p>
        <p class="Body">The multiple resampling routines can apply a single reference map table to a set of sequences stored as rows or columns in a matrix. </p>
        <p class="Body"><a href="#Resampling_Application_Flow" target="" title="" alt="" class="MCXref_FigTabExam"><span style="color: DarkBlue;" class="mcFormatColor">Figure 4-3</span></a> illustrates a typical resampling application flow.</p>
        <p class="Image" style="page-break-after: avoid;">
            <img src="../Resources/Images/SAL_resampling_flow_480x80.jpg" style="width: 480; height: 80;" />
        </p>
        <p class="CaptionNumChap_Figure" MadCap:autonum="&lt;b&gt;Figure 4-3: &lt;/b&gt;"><span class="autonumber"><span><b>Figure 4-3: </b></span></span><a name="Resampling_Application_Flow"></a>Resampling Application Flow</p>
        <h2><a name="Filter"></a><a name="kanchor103"></a>Filter Set and Reference Map Memory Allocation</h2>
        <p class="Body">The <a href="Resampling_functions.htm#resamp_filter_create">resamp_filter_create()</a> and <a href="Resampling_functions.htm#resamp_map_create">resamp_map_create()</a> routines take an optional output parameter called <i>num_bytes</i>, which, if non-<code>NULL</code>, receives the number of bytes allocated for internal data structures, tables, and buffers associated with each object.</p>
        <p class="Body">You can determine the required number of bytes for the <a href="Resampling_functions.htm#resamp_filter_create">resamp_filter_create()</a> and <a href="Resampling_functions.htm#resamp_map_create">resamp_map_create()</a> routines without allocating any memory or creating objects.</p>
        <p class="StepStart">To determine the required number of bytes for an allocation:</p>
        <ul>
            <li class="SingleStep" value="1">Specify a <code>NULL </code>pointer for the <code>filter_handle</code> or <code>map_handle</code>.</li>
        </ul>
        <table style="width: 500px;mc-table-style: url('../Resources/TableStyles/o_Note.css');" class="TableStyle_o_Note" cellspacing="0">
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_o_Note_Body_0_0_RowSep_ColEnd">
                        <p class="Note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #06347a;&quot; class=&quot;mcFormatColor&quot;&gt;Note&lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #06347a;" class="mcFormatColor">Note</span></b></span></span>&#160;</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_o_Note_Body_0_0_RowEnd_ColEnd">The number of bytes (<i>num_bytes</i>) cannot be <code>NULL </code>simultaneously with the <code>filter_handle </code>or the <code>map_handle</code>.</td>
                </tr>
            </tbody>
        </table>
        <p class="Body">This is particularly useful if you prefer to allocate the buffer space required by the object explicitly instead of  letting SAL perform the allocation internally. For this purpose, the resampling functionality provides two additional create routines: </p>
        <ul>
            <li value="1"><a href="Resampling_functions.htm#resamp_filter_create_user_alloc"><a href="Resampling_functions.htm#resamp_filter_create_user_alloc">resamp_filter_create_user_alloc()</a></a> <![CDATA[ ]]></li>
            <li value="2"><a href="Resampling_functions.htm#resamp_map_create_user_alloc">resamp_map_create_user_alloc()</a>
            </li>
        </ul>
        <p class="Body">where, in place of the num_bytes parameter, you provide a pre-allocated buffer for internal storage. You are responsible for freeing this memory after closing the associated resampling object.</p>
        <p class="Body">Explicit memory allocation improves performance in applications where the create routines are called frequently. Because they do not have to allocate memory for their internal storage, the <a href="Resampling_functions.htm#resamp_filter_create_user_alloc">resamp_filter_create_user_alloc()</a> and <a href="Resampling_functions.htm#resamp_map_create_user_alloc">resamp_map_create_user_alloc()</a> routines outperform and perform more deterministically than the standard <a href="Resampling_functions.htm#resamp_filter_create">resamp_filter_create()</a> and <a href="Resampling_functions.htm#resamp_map_create">resamp_map_create()</a> routines. </p>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script><iframe id="topiccomments" name="topiccomments" title="Topic Comments" src="../../Skin/TopicComments.htm" frameborder="0" style="width: 100%; height: 0px; margin-top: 12px;"></iframe>
    </body>
</html>