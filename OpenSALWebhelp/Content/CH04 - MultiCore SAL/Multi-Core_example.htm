<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="3" MadCap:lastHeight="1209" MadCap:lastWidth="613" MadCap:disableMasterStylesheet="true" MadCap:tocPath="" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:liveHelp="BMbZbWGbniJL/TKc5nH7AeUy6UuWq2vVUNHuZu0wjwfdYJVJ+SWNTzZk/d6V+N/0pO1HNKi2hubVdP7ISnYqqXUsMXWDdG5Im69ch6Yz3YcxaGINoSMTAYfTroKj+/LY2u504lCI3w+/GCf2GpJyXG2KoKWCNnHnf8vqBNcmt04j9Ok5RKB57DdLVaDvKhkClt+taaaxQHZUsGjkiMwEM3E+PNxE6Hrzrkk3PCshCM0uTl86/Ns1/qkvZmTkx0yEh5YMQGJZxabNwjB+coBnQtwh/Gi1NtAhW8gtCIvrIHWndyMLhSEzkQgXYAffgfglKNRcpc3UxuhyQos2h7stLnkcSnwqmEVLOiN+rFkrfrBYsNj9YeDeuhB559irsAzHTLr/DuvUoTiiUT8x9i4Ad60UYRgC16N24Tmh4CM6UrOMxSk5fkaocoX7npzCKzTOFZfzAfKlEyYSTnjWxZgh6ZAf0ekCUx4o6JQ5lrCebqSD+SZ6gNrR//9ODBmx6JvgkN/IZ4NhDqbA/phkpR1n8AVJlejGRhFt21Cwd4ppT/XDO9/6lpnrQ8l/Zt7KZhmjcYwykxM5thtEj15bf7RxWtyPEeIn3SAy/r7jc1Hzwd/xzr/BA45n9aAfXKOll7ulqMdQ/JL/I7s0dWGmfKc3CXlxaAaw3DFXlKuNthiLVtahcFGHwaLaRnKridCEgGYopq0bHBkWa4PgbAeUU4A+DNqJUywbyrRwkXar2F8p/+zEQ62UTy/LbiA7hYBh8NnFfFWk5YCwGPko+gY7lQvBNzW05jhqMHXLDP+ABAmbupuYWTf6AGpoUGjrjAyK0+azadM6MmCX/HAJNUED1p55sGd3ePiYfg/UdStQyxIb0a/sQLzICunYyByTyo+ZGoFh8rKV94f1tB2sk7s64mppIcDsTnlirSvMOGPd+2ANdPn2IYPza/w01+zkJ8w6+WUo4k/z6DdSpoUDsqQVJuzMZJ8bC2LminI0aXMYlaKAEoG9uHJfdBhifMbryavmvnWg" MadCap:PathToHelpSystem="../../" MadCap:HelpSystemFileName="Default.xml" MadCap:SearchType="Stem">
    <head>
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" type="text/css" /><title>Multi-Core Example </title>
        <link href="../Resources/TableStyles/o_Code.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/o_Note.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/p_Code.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/p_Note.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/Stylesheets/BookStyles.css" rel="stylesheet" type="text/css" />
        <script src="../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapLiveHelpUtilities.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapLiveHelpBody.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapAddCommentDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapReplyCommentDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapRegisterUserDialog.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../Default_CSH.htm#CH04 - MultiCore SAL/Multi-Core_example.htm" style="">Open topic with navigation</a>
        </p>
        <h1 style="page-break-before: auto;page-break-after: auto;"><a name="kanchor1176"></a>Multi-Core Example </h1>
        <p class="Body"><a name="kanchor1177"></a><a href="#Executing_a_SAL_Function" target="" title="" alt="" class="MCXref_FigTabExam"><span style="color: DarkBlue;" class="mcFormatColor">Example 12-1</span></a> shows how to use more than one core to execute a SAL function. It also shows how to invoke an individual single-core SAL function by using the <code>SAL_SINGLE </code>macro to qualify the function name.</p>
        <table style="width: 500px;caption-side: top;mc-table-style: url('../Resources/TableStyles/o_Note.css');" class="TableStyle_o_Note" cellspacing="0">
            <col />
            <tbody>
                <tr>
                    <td class="TableStyle_o_Note_Body_0_0_RowSep_ColEnd">
                        <p class="Note" MadCap:autonum="&lt;b&gt;&lt;span style=&quot;color: #06347a;&quot; class=&quot;mcFormatColor&quot;&gt;Note&lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #06347a;" class="mcFormatColor">Note</span></b></span></span>&#160;</p>
                    </td>
                </tr>
                <tr>
                    <td class="TableStyle_o_Note_Body_0_0_RowEnd_ColEnd">MCSAL example files are located in <code>$MC_DIR/examples/mcsal/</code>.</td>
                </tr>
            </tbody>
        </table>
        <p class="CaptionNumChap_Example" style="page-break-before: auto;page-break-after: auto;" MadCap:autonum="&lt;b&gt;Example 12-1: &lt;/b&gt;"><span class="autonumber"><span><b>Example 12-1: </b></span></span><a name="Executing_a_SAL_Function"></a>Executing a SAL Function on Multiple Cores</p>
        <table style="width: 500px;caption-side: top;mc-table-style: url('../Resources/TableStyles/o_Code.css');" class="TableStyle_o_Code" cellspacing="0">
            <col />
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">#define SAL_ENABLE_MULTICORE /* must be defined in the Makefile or before sal.h is included */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">#include &lt;sal.h&gt;</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">SAL_i32 main (SAL_i32 argc, SAL_char * const argv[])</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">{</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">&#160; SAL_i32 n_elems;</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">&#160;
                 SAL_f32 *A = NULL;</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">&#160;
                 SAL_f32 *B = NULL;</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">&#160;
                 SAL_f32 *C = NULL;</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">&#160;
                 SAL_i32 rc;</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">/* --- find out how many elements */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">SAL_i32 n_elems = atoi ( argv [ 1 ] );</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">/* =============================================================</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">If SAL_ENABLE_MULTICORE is defined, the manager thread creates a SAL handle to manage threads and cores. The manager initializes SAL handle and creates worker threads.</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">==============================================================*/</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">SAL_handle sal_handle;</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">/* Create a sal_handle */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">rc = sal_create(&amp;sal_handle);</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">CHECK_RC(rc);</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">*/ Create worker threads and other MCSAL structures for managing the threads */rc = sal_init(sal_handle);</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">CHECK_RC(rc);</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">/* --- allocate aligned memory ---------------------------- */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">. . .</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">/* --- Initialize source buffers -------------------------- */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">. . .</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">/* =============================================================</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">Run multi-core vaddx.</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">==============================================================*/</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">vaddx( A, 1, B, 1, C, 1, n_elems, SAL_NNN);</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">/* =============================================================</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">Run single-core vaddx.</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">==============================================================*/</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">/* =============================================================</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">Other MCSAL functions ...</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">==============================================================*/</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">SAL_SINGLE(vaddx)( A, 1, B, 1, E, 1, n_elems, SAL_NNN); </td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">/* =============================================================</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">Join MCSAL worker threads and release other resources used by MCSAL.</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">==============================================================*/</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">rc = sal_destroy(sal_handle);</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">CHECK_RC(rc);</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">return 0;</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">}</td>
            </tr>
        </table>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script><iframe id="topiccomments" name="topiccomments" title="Topic Comments" src="../../Skin/TopicComments.htm" frameborder="0" style="width: 100%; height: 0px; margin-top: 12px;"></iframe>
    </body>
</html>