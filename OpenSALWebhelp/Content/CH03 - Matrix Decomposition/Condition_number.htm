<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="4" MadCap:lastHeight="748" MadCap:lastWidth="654" MadCap:disableMasterStylesheet="true" MadCap:tocPath="About Matrix Decomposition" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:liveHelp="htq/Ahn6MbdRniMYNx+LHIggac/Qcb3cg9qxTKjYpGPlMUQ93C2Dm7eZVC2/SYANROJXAj3kO1vVVVnSWAP2HPSnRjny7HWxf3J0ILbcboiQQHR0R9lU5f0m/Mc73my+w14WtpmVM1Spg5VaqdadvXhWa39R8+aBdVVVb7hfoQnvvW2RYz3oY1B2Qth/su/7B+pTLcs6EvGI6OLNlg0W/qCqsLNwRzJqymQSjr7GXdxWDFviOilP8HLTMKegyhFwirWKfduEOPB3MMSWItPajoPC5mVcYIukuOiahEUqw9Bsyd0nx8Xc4YpxYzi48nZMSg3t9eEQFC7BbR+Cf0YxY2t4XNZnc0rGPLxdKH/HeoyvBqbShGiuZD8Dy7jlJ8fkCs72OjmcbInLLWZ0fuL+fmaG+K7eVSXoCZ8HO7aV2CLQ4IDaTGHKZjJb9p5vme+jwVu2OFzgVhnxb8+6noVCbFNKqo8pqg8PxeK0TKym2ZdPDNQVB7h9Zve2Ntbwyvk+Bii4vW329sKEgJE55j5XS2dI6oTMNp1xVdlRImjHnY/yHrWJUajXDJcqADWqX2Lqrtw42sI46+LvLZL+RA1Cix9ieRQZSyaEtFg8IgG7/WiBVSvHZTehtmAFgru9KphKgOS8tKAkoG7l06tKxxDbGJx53T6dJn/lyvPe38k3rgcrFuR7dWmtnEoIGuSAw45uuYLgEXAzRK53hF4bt+5WeVjQrJYfX5jFWjAMA+wKWWkJtMUJdZGyY2AYboGl7NvB2JMcg/JdANgDBerFU3c9URfcgkLK9lAtmjnV/QZ2I2IFtFxvb/4X2+CAwCQ6azqhob1Zz6yCoYARgjBrTr9Ee+JQBi0xlkSfX+hTtOet02mVcei7jtVQ5vEYRZ8vZdIZcaCMVW5BBf6mJhP7R0ciflNVQ33hHAxMTOecLD5x/meVDex1YfOLhLvJVCN+sP8AhSMTIr4etOpQh9Tgl2MZxYD2hD80JuILTIs//he8M639MtL1shisQfhcVQow08Xf" MadCap:PathToHelpSystem="../../" MadCap:HelpSystemFileName="Default.xml" MadCap:SearchType="Stem">
    <head>
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" type="text/css" /><title>Condition Number Estimation</title>
        <link href="../Resources/Stylesheets/BookStyles.css" rel="stylesheet" type="text/css" />
        <script src="../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapLiveHelpUtilities.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapLiveHelpBody.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapAddCommentDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapReplyCommentDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapRegisterUserDialog.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../Default_CSH.htm#CH03 - Matrix Decomposition/Condition_number.htm" style="">Open topic with navigation</a>
        </p>
        <h1 style="page-break-before: avoid;"><a name="kanchor76"></a>Condition Number Estimation</h1>
        <p class="Body">Condition number estimation refers to the problem of calculating a rough order of magnitude estimate of the condition number of a matrix that is based on a previously computed decomposition of the matrix (see <a href="LU_decomposition.htm" target="" title="" alt="" class="MCXref_See_NoPrefix"><span style="color: DarkBlue;" class="mcFormatColor"><i>LU Decomposition</i></span></a>, <a href="Cholesky.htm#top" target="" title="" alt="" class="MCXref_See_NoPrefix"><span style="color: DarkBlue;" class="mcFormatColor"><i>Cholesky Decomposition</i></span></a> and <a href="QR_decomposition.htm" target="" title="" alt="" class="MCXref_See_NoPrefix"><span style="color: DarkBlue;" class="mcFormatColor"><i>QR Decomposition</i></span></a>.</p>
        <p class="Body"><a name="kanchor77"></a>The SAL functions that estimate matrix condition are:</p>
        <ul>
            <li value="1"><a href="../CH10 - Functions - Matrix Math/Matrix Invert.htm#matinvx">matinvx()</a>
            </li>
            <li value="2"><a href="../CH10 - Functions - Matrix Math/Matrix Invert.htm#matinvdx">matinvdx()</a>
            </li>
            <li value="3"><a href="../CH10 - Functions - Matrix Math/Matrix Invert.htm#matinv_lux">matinv_lux()</a>
            </li>
            <li value="4"><a href="../CH10 - Functions - Matrix Math/Matrix Invert - Complex.htm#cmatinv_lux">cmatinv_lux()</a>
            </li>
            <li value="5"><a href="../CH10 - Functions - Matrix Math/Matrix Invert - Complex.htm#zmatinv_lux">zmatinv_lux()</a>
            </li>
        </ul>
        <h2><a name="Matrix"></a><a name="kanchor78"></a>Matrix Condition Numbers</h2>
        <p class="Body">A matrix <i>A</i> is called ill-conditioned if relatively small changes in the entries of <i>A</i> or <i>b</i> can result in large changes in the solutions to the linear system <i>A</i> • <i>x</i> = <i>b</i>. Conversely, if all small changes in <i>A</i> or <i>b</i> result in small changes only in the solution vector <i>x</i>, then <i>A</i> is well-conditioned.</p>
        <p class="Body">The condition number of a matrix is a quantitative measure of the sensitivity of solutions of a linear system to perturbations of <i>A</i> or <i>b</i>. For a square, non-singular matrix <i>A</i>, the condition number k<sub>p</sub>(<i>A</i>) (or the normwise condition number with respect to inversion) is defined in <a href="Terms.htm#Equation_6" target="" title="" alt="" class="MCXref_Equation" MadCap:conditions="Default.ScreenOnly"><span style="color: DarkBlue;" class="mcFormatColor">Equation (6)</span></a>.</p>
        <p class="Body">The condition number is greater than or equal to 1.0 for all matrices. It is large for an <br />ill-conditioned matrix, infinite (by convention) for a singular matrix, and close to 1.0 for a well-conditioned matrix. How large a condition number must be for the matrix to be considered ill-conditioned, depends on the context. This includes the numerical properties of the algorithm in which the matrix is used, and the output accuracy requirements. An extremely large condition number, on the order of the reciprocal of the machine epsilon (ε = 6<i>e</i><sup>–8</sup> for single precision), is a sign of trouble.</p>
        <p class="Body">The minimizing vector for ||<i>A</i> • <i>x</i>||<sub>1</sub> / ||<i>x</i>||<sub>1</sub> (often referred to as an <i>approximate null vector</i> when <i>A</i> is ill-conditioned) is the vector <i>v</i> for which ||<i>A</i> • <i>v</i>||<sub>1</sub> = ||<i>A</i>||<sub>1</sub> • ||<i>v</i>||<sub>1</sub> <![CDATA[ ]]>• (reciprocal of the estimated condition number).</p>
        <h2><a name="kanchor79"></a>Norms and Condition Numbers</h2>
        <p class="Body">The most important practical cases of the condition number k<sub>p</sub>(<i>A</i>) are p = 1, 2, or ∞. As noted in <a href="#Matrix" target="" title="" alt="" class="MCXref_See_NoPrefix" MadCap:conditions="Default.ScreenOnly"><span style="color: DarkBlue;" class="mcFormatColor"><i>Matrix Condition Numbers</i></span></a>, k<sub>2</sub> has several properties not shared by k<sub>1</sub> and k<sub>∞</sub>:</p>
        <ul>
            <li value="1">k<sub>2</sub>(<i>A</i>) = σ<sub>1</sub>/σ<sub>n–1</sub></li>
            <li value="2">k<sub>2</sub>(<i>A</i>) = k<sub>2</sub>(<i>R</i>)</li>
            <li value="3">k<sub>2</sub>(<i>U</i>) = 1 if <i>U</i> is a unitary matrix</li>
        </ul>
        <p class="Body">On the other hand, some of the most practical condition estimation methods apply to k<sub>1</sub> and k<sub>∞</sub>, but not to k<sub>2</sub>.</p>
        <p class="Body">If it is not clear from the context which type of norm is being used, Mercury documentation uses subscripts with the norm and condition number symbols. For example, the 2-norm condition number:</p>
        <p class="Body1"> k<sub>2</sub>(<i>A</i>) = ||<i>A</i>||<sub>2</sub> • ||<i>A</i><sup>–1</sup>||<sub>2</sub> <![CDATA[ ]]></p>
        <p class="Body">is the type of condition number provided as one of the outputs of the SVD function, <a href="../CH10 - Functions - Matrix Math/Singular Value Decomposition.htm#zmat_svdx">zmat_svdx()</a>, and the Hermitian eigenvalue function, <a href="../CH10 - Functions - Matrix Math/Eigenvalues Eigenvectors.htm#zmatherm_eigx">zmatherm_eigx()</a>.</p>
        <p class="Body">Selecting a condition number type to use depends on how applicable the number is to the particular problem, and how difficult the type is to estimate. All of the p-norm condition numbers (p = 1, 2, …, or p = ∞) are equally applicable in the sense that for any <i>p</i> and <i>q</i>, k<sub>p</sub> and k<sub>q</sub> are always within a dimension-dependent multiple of each other. For example, the following bounds relate k1 and k2:</p>
        <ul>
            <li value="1">k<sub>1</sub>(<i>A</i>) ≤ n • k<sub>2</sub>(<i>A</i>)</li>
            <li value="2">k<sub>2</sub>(<i>A</i>) ≤ n • k<sub>1</sub>(<i>A</i>)</li>
        </ul>
        <p class="Body">While normwise condition numbers k<sub>p</sub>(<i>A</i>) are all equivalent in the above sense, componentwise condition cond(<i>A</i>) (see <a href="Terms.htm#Equation_7" target="" title="" alt="" class="MCXref_Equation" MadCap:conditions="Default.ScreenOnly"><span style="color: DarkBlue;" class="mcFormatColor">Equation (7)</span></a><a href="Terms.htm#Equation_7" target="" title="" alt="" class="MCXref_EquationPage" MadCap:conditions="Default.PrintOnly"><span style="color: Black;" class="mcFormatColor">For more information, see </span><i><span style="color: DarkBlue;" class="mcFormatColor"></span></i><span style="color: Black;" class="mcFormatColor"> on page 1.</span></a>) can reveal qualitatively different information about a matrix. For example, it is possible to build a system of equations <i>A</i> • <i>x</i> = <i>b</i> where the k(<i>A</i>)-based estimate of the error Δ<i>x</i> induced by a certain perturbation Δ<i>b</i> is useless (grossly overestimates the error), while cond(<i>A</i>) provides an acceptable estimate. You can analyze this type of directional sensitivity using SVD (see <a href="SVD.htm#top" target="" title="Go to Singular Value Decomposition" alt="Go to Singular Value Decomposition" class="MCXref_See_NoPrefix" MadCap:conditions="Default.ScreenOnly"><span style="color: DarkBlue;" class="mcFormatColor"><i>Singular Value Decomposition</i></span></a>), but at a greater computational cost than using a componentwise condition estimate.</p>
        <p class="Body">For this reason, the SAL functions that estimate matrix condition include a flag parameter to select between the normwise and componentwise condition numbers. </p>
        <h2><a name="kanchor80"></a>Performance</h2>
        <p class="Body">Condition estimators provide an estimate of condition that is significantly faster than performing an SVD, given a prior LU or other triangular decomposition. Enhanced LU decomposition functions provide an estimate of k<sub>1</sub>(<i>A</i>), k<sub>∞</sub>(<i>A</i>), or cond(<i>A</i>) as an optional output at a modest cost of <i>O</i>(n) flops, compared to the <i>O</i>(n<sup>2</sup>) cost of the LU decomposition.</p>
        <p class="Body">To get the fastest possible LU decomposition, you can omit the condition number estimate, or include the estimate if your application is at risk of producing inaccurate or meaningless results due to an ill-conditioned matrix <i>A</i>. When an ill-conditioned matrix is detected, there might still be a way to mitigate the sensitivity and obtain a usable result; for example, by adding noise to the input matrix and recomputing the decomposition.</p>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script><iframe id="topiccomments" name="topiccomments" title="Topic Comments" src="../../Skin/TopicComments.htm" frameborder="0" style="width: 100%; height: 0px; margin-top: 12px;"></iframe>
    </body>
</html>