<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="3" MadCap:lastHeight="765" MadCap:lastWidth="654" MadCap:disableMasterStylesheet="true" MadCap:tocPath="" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:liveHelp="NZnugtFpENBhH3ODhOOPE6JFX4ZRrXAFdTJH+Rq98/99vxGvQIGFb+mobyv/n1C6WldsDn0MO59td1Cs5tgapoi+xxbchiTfqzZ4tPlGYrI33ZzYCS5cLyydYrr0ZIp88OMqiqVAqfXqe5sbXN402H5+soDvFmVAWwSHouj2VSqAPZUzni+mJykrBU5g5HlpAU34chDRg95iX7i3o7RI1IAEpYklhjKHaqPDc/mbZPNc9kv1QH1PbyN3crszxxFpywsxmkU3rYUT6E8w4YUZv+TnOASowT2C7R5FMM7gY5mgl7rAmJTVev9XVM//pSrGZ6EOmvq1KyJjAeORCeTb6CASLyDF9+/NhpBVUSJF78Q38sDs600wkHKXxtNeZPpieL0470d0LwzIpqFJRogdpFuOK424OVPC8B7eja5/5eSwsQRZB1lvv2ndyYozIsuyb1+mwvGjU3qc6koF/Xh6FpK012yDw49BuRj5AI2BtrKIMG/oNxpK2CunyNklgFvyfM6sMThOQTKH6xbuUUTdZ+YLLk6SQV+Wd0+EozKnfoFO4JseKaHGI+8dhA7qu1muePamMTZwNV964HhAq37YDriD1BTehLv22nSMgcdm6UyOtXkWyZxssz7jCRXPqQtIVs1rENLQn+h9iU4v2PzvdvZpJgIgUrVfZyZhjGWmWwR5+Wd3c5FamaEfFp0Vzg4ao1Efhf1A+PGcxLS562pq9PkNU4sm1GegTZobYr37X1G+3yEvrXDmawtcYkAiJR1tcRYWoh1XLQbzmrc4aQB0/m6/EgQB3AJ4E5IasxaMSsRVrKC2nOui6LlpVH2yWXUrMsdRU/t8zFNnEAG9JxafOMkozcUdI2MEerBFuaUIWK0JpyCgLGAQsyCuXHGkssOOgQ4fjxb3UxwRo0Y4p/X7sPe61XFhK+r+1oSRIcU5OvlkM6+k7t6Ls9pQQAPySndVXSAnXzxq7mHKB9qhw3o+7cd4D9VWdgcLYO7u9FT5p2ll5Nq9caglgdcVJ9saNM12oocdkYIihomTdPs+DpIc84JS2kdMFi91KFN5+FP2i5Z9Gc5/VDZuTgf43+5ZLrJx5C3qFBeXzv4kJ1z3jwZF92umn7Tm7mcDFFJT4tDimRe0TGTQV6s/bNPgG9EV4Gls3u5cF/NGEJACSglraS/tE7dzmIFs2q3TTabRsCcK6RSsoUqDwHqsVOf9jCJHnf66bmE0C9DAPeQH5o5CKlpEk4eLMSYpayTAAlT4rshz699DHHFzdt0Q1EbKIeoFKmLk3c56G0/YpavfffzieGc6Uhoqike2yYjE5jPfY/q9LHW4O2PIghXuHvRcf0xiY6dpm96VjHXc4BrkN33mK6jj2Q==" MadCap:PathToHelpSystem="../../" MadCap:HelpSystemFileName="Default.xml" MadCap:SearchType="Stem">
    <head>
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" type="text/css" /><title>Modified Gram-Schmidt QR Decomposition Kernel and Auxiliary R-Transpose</title>
        <link href="../Resources/TableStyles/o_InvisibleIndent.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/o_Code.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/p_Code.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/p_InvisibleIndent.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/p_Code.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/Stylesheets/BookStyles.css" rel="stylesheet" type="text/css" />
        <script src="../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapLiveHelpUtilities.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapLiveHelpBody.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapAddCommentDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapReplyCommentDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapRegisterUserDialog.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../Default_CSH.htm#CH10 - Functions - Matrix Math/Modified Gram-Schmidt QR Decomposition.htm" style="">Open topic with navigation</a>
        </p>
        <h2><a name="kanchor1198"></a>Modified Gram-Schmidt QR Decomposition Kernel and Auxiliary R-Transpose</h2>
        <p class="API_name"><a name="matmgs_dkerx"></a><a name="kanchor1199"></a>matmgs_dkerx(), <a name="matmgs_trx"></a><a name="kanchor1200"></a>matmgs_trx()</p>
        <p class="API_heads">Syntax</p>
        <table style="width: 500px;caption-side: top;mc-table-style: url('../Resources/TableStyles/o_Code.css');" class="TableStyle_o_Code" cellspacing="0">
            <col style="width: 55px;">
            </col>
            <col style="width: 125px;">
            </col>
            <col style="width: 330px;">
            </col>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">void <b>matmgs_dkerx</b>(</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_f32 *AT,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* input/output matrix */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 AT_tcols,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix AT total no. of columns (A row stride) */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_f32 *Pvec,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* input vector, pivot */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_f32 *Rvec,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* output vector */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 m,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* i/o matrix col. count and length of Pvec */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 n,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* i/o matrix row count and length of Rvec */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 eflag );</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* ESAL flag */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">void <b>matmgs_trx</b>(</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_f32 *R,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* input/output matrix */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 tcols,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix R total number of columns */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 n,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* number of rows and columns in R */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 eflag );</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* ESAL flag */</td>
            </tr>
        </table>
        <p class="API_heads">Description</p>
        <p class="Body">The matmgs_dkerx() function computes part of one stage of a decomposition algorithm. The decomposition is a thin QR decomposition using the Modified Gram-Schmidt (MGS) method. This function allows you to implement parallel computations for decompositions in applications running on multiple processors.</p>
        <p class="Body">The MGS algorithm factors a matrix <i>A </i>as <i>A </i>= <i>Q </i>* <i>R</i>, where <i>Q </i>has orthonormal columns and <i>R </i>is upper triangular. For an (<i>m </i>x <i>n</i>) matrix <i>A</i>, this is an <i>n</i>-stage iterative procedure, where the <i>k</i>-th stage generates the <i>k</i>-th column of <i>Q </i>and the <i>k</i>-th row of <i>R</i>, and updates the last (<i>n-k</i>) columns of <i>A</i>. In terms of the MGS kernel routines, the MGS algorithm is:</p>
        <p class="Body1" style="font-family: monospace;">for <i>k </i>= 1 to <i>n</i></p>
        <p class="Body2" style="font-family: monospace;">Normalize <i>k</i>-th column of <i>A</i></p>
        <p class="Body2" style="font-family: monospace;">Pivot vector = <i>k</i>-th column of <i>A</i></p>
        <p class="Body2" style="font-family: monospace;">Apply kernel routine to last (<i>n–k</i>) columns of <i>A</i></p>
        <p class="Body1" style="font-family: monospace;">end for</p>
        <p class="Body">The normalization step is not included in the kernel function; in a parallel implementation this would interfere with the partitioning of the problem among processors. That is, the problem can be partitioned by columns of the matrix <i>A</i>, provided that on each stage, each processor has a copy of the pivot vector.</p>
        <p class="API_heads">Parameters</p>
        <p class="Parameter">AT</p>
        <p class="Body1">An input matrix that is the transpose of matrix <i>A</i>. On exit, the input matrix storage contains the updated matrix <i>A</i>.</p>
        <p class="Parameter">AT_cols </p>
        <p class="Body1">The matrix <i>AT </i>column element stride, which is the matrix <i>A </i>row element stride.</p>
        <p class="Parameter">Pvec </p>
        <p class="Body1">The input pivot vector, <i>q</i>[<i>k</i>]. </p>
        <p class="Parameter">Rvec </p>
        <p class="Body1">The output <i>R </i>vector. </p>
        <p class="Parameter">m</p>
        <p class="Body1">The input matrix <i>AT </i>column count and the length of <i>Pvec</i>. </p>
        <p class="Parameter">n </p>
        <p class="Body1">The input matrix <i>AT </i>row count and the length of <i>Rvec</i>.</p>
        <p class="Body">For single processor applications, there is no advantage to the kernel functions over the complete decomposition function, matmgs_dqrx().</p>
        <p class="API_heads">R-transpose Auxiliary Functions</p>
        <p class="Body">After using the kernel decomposer functions, you must call the corresponding auxiliary <i>R</i>-transpose function  before you call the MGS QR solvers. The corresponding auxiliary <i>R</i>-transpose function is matmgs_trx().</p>
        <p class="Body">This function operates on the upper triangular <i>R </i>matrix created from the collected kernel decomposer outputs. The auxiliary functions generate a special packed <i>R</i>-transpose format required by the MGS QR solvers.</p>
        <p class="Body">The input matrix <i>R </i>is the collected upper triangular <i>R </i>matrix generated from <i>n </i>or more kernel decomposer outputs.</p>
        <p class="Body">The input parameter <i>tcols </i>is the matrix <i>R </i>column element stride. The number of rows and columns in matrix R is <i>n</i>.</p>
        <p class="Body">The auxiliary functions replace the lower triangular part (zeros) below the diagonal in <i>R </i>with the transpose of the upper triangle.</p>
        <p class="Body">For example, if <i>n </i>= 4, the theoretical <i>R </i>matrix is:</p>
        <table class="TableStyle_o_InvisibleIndent" style="caption-side: top;width: 250px;mc-table-style: url('../Resources/TableStyles/o_InvisibleIndent.css');" cellspacing="0">
            <col style="width: 40px;">
            </col>
            <col style="width: 40px;">
            </col>
            <col style="width: 40px;">
            </col>
            <col style="width: 40px;">
            </col>
            <tbody>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r00</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r01</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r02</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColEnd">r03</td>
                </tr>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">0</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r11</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r12</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColEnd">r13</td>
                </tr>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">0</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">0</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r22</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColEnd">r23</td>
                </tr>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColSep">0</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColSep">0</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColSep">0</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColEnd">r33</td>
                </tr>
            </tbody>
        </table>
        <p class="Body">The corresponding 4 x 4 matrix in special <i>R </i>matrix format (with “don’t care” elements denoted by X), before the transpose is:</p>
        <table class="TableStyle_o_InvisibleIndent" style="caption-side: top;width: 250px;mc-table-style: url('../Resources/TableStyles/o_InvisibleIndent.css');" cellspacing="0">
            <col style="width: 40px;">
            </col>
            <col style="width: 40px;">
            </col>
            <col style="width: 40px;">
            </col>
            <col style="width: 40px;">
            </col>
            <tbody>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">1/r00</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r01</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r02</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColEnd">r03</td>
                </tr>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">X</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">1/r11</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r12</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColEnd">r13</td>
                </tr>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">X</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">X</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">1/r22</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColEnd">r23</td>
                </tr>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColSep">X</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColSep">X</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColSep">X</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColEnd">1/r33</td>
                </tr>
            </tbody>
        </table>
        <p class="Body">The corresponding 4 x 4 matrix in special <i>R </i>matrix format, after the transpose is:</p>
        <table class="TableStyle_o_InvisibleIndent" style="caption-side: top;width: 250px;mc-table-style: url('../Resources/TableStyles/o_InvisibleIndent.css');" cellspacing="0">
            <col style="width: 40px;">
            </col>
            <col style="width: 40px;">
            </col>
            <col style="width: 40px;">
            </col>
            <col style="width: 40px;">
            </col>
            <tbody>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">1/r00</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r01</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r02</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColEnd">r03</td>
                </tr>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r01</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">1/r11</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r12</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColEnd">r13</td>
                </tr>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r02</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">r12</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColSep">1/r22</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowSep_ColEnd">r23</td>
                </tr>
                <tr>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColSep">r03</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColSep">r13</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColSep">r23</td>
                    <td class="TableStyle_o_InvisibleIndent_Body_0_0_RowEnd_ColEnd">1/r33</td>
                </tr>
            </tbody>
        </table>
        <p class="Body">After calling the auxiliary <i>R</i>-transpose functions, you can call the solvers multiple times with different values for <i>B</i>, the right-hand side vector.</p>
        <p class="Body">The matmgs_dqrx() function performs a complete MGS QR decomposition and creates the special <i>R </i>matrix format internally. Do not use the auxiliary <i>R</i>-transpose functions with the complete MGS QRD functions.</p>
        <p class="API_heads">Example</p>
        <p class="Body">This example is a single processor implementation of an MGS QR Decomposition using matmgs_dkerx().</p>
        <p class="Body">This loop computes an MGS QRD of an (<i>M </i>x <i>N</i>) matrix <i>A </i>by calling matmgs_dkerx() once per loop iteration. The matrix <i>AT </i>(transpose of the <i>A </i>matrix) is overwritten by <i>QT </i>(transpose of the Q matrix). Entries of <i>R </i>below the diagonal are implicitly zero and are not written.</p>
        <p class="CaptionNumChap_Example" MadCap:autonum="&lt;b&gt;Example 12-2: &lt;/b&gt;"><span class="autonumber"><span><b>Example 12-2: </b></span></span>Single processor implementation of an MGS QR decomposition using matmgs_dkerx()</p>
        <table style="caption-side: top;width: 500px;mc-table-style: url('../Resources/TableStyles/o_Code.css');" class="TableStyle_o_Code" cellspacing="0">
            <col>
            </col>
            <col style="width: 51px;">
            </col>
            <col style="width: 86px;">
            </col>
            <col>
            </col>
            <col style="width: 233px;">
            </col>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">Acol = AT;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">/* initialize A column (AT row) pointer */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">Rrow = R;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">/* initialize R matrix row pointer */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="5">for (k = 0; k &lt; n; k++ ) {</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">Qpivot = Acol;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">&#160; /* "pivot" is normalized column of A */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">Acol += At_tcols;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="2">&#160; /* advance to next col. of A (row of AT) */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">/* compute Euclidian length-squared of pivot */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="4">svesqx( Qpivot, 1, &amp;dot, m, SAL_C );</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">/* normalize pivot to unit length */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="4">len_recip = 1.0/sqrt(dot);</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="4">vsmulx( Qpivot, 1, &amp;len_recip, Qpivot, 1, m, SAL_C );</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">/* k-th diagonal element of R matrix = 1/length */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="4">*Rrow++ = len_recip;</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">/*Perform kernel operation: Dot the pivot with */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">/*remaining columns of A, and update each column by */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">/*subtracting dot * pivot */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="4">matmgs_dkerx( Acol, At_tcols, Qpivot, Rrow, m, n-k-1, SAL_NCN );</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="4">Rrow += R_tcols; /* advance to main diagonal in next row of R */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="5">}</td>
            </tr>
        </table>
        <p class="RelatedTopics" MadCap:autonum="Related Topics"><span class="autonumber"><span>Related Topics</span></span>&#160;</p>
        <p class="Body"><a href="../CH03 - Matrix Decomposition/LU_decomposition.htm#top" target="" title="" alt="" class="MCXref_See_NoPrefix" MadCap:conditions="Default.ScreenOnly"><span style="color: DarkBlue;" class="mcFormatColor"><i>LU Decomposition</i></span></a>
        </p>
        <p class="RelatedFunctions" MadCap:autonum="Related Functions"><span class="autonumber"><span>Related Functions</span></span>&#160;</p>
        <p class="Body"><a href="Matrix MGS QR Solutions.htm#mat_mgs_solrx" target="" title="" alt="" class="MCXref_See_NoPrefix" MadCap:conditions="Default.ScreenOnly"><span style="color: DarkBlue;" class="mcFormatColor"><i>mat_mgs_solrx(), mat_mgs_solrdx(), mat_mgs_solrhrx(), mat_mgs_solrhrdx</i></span></a>
        </p>
        <p class="Body"><a href="Matrix MGS QR Solutions - Complex.htm#cmat_mgs_solrx" target="" title="" alt="" class="MCXref_See_NoPrefix" MadCap:conditions="Default.ScreenOnly"><span style="color: DarkBlue;" class="mcFormatColor"><i>cmat_mgs_solrx(), cmat_mgs_solrdx(), cmat_mgs_solrhrx(), cmat_mgs_solrhrdx(), zmat_mgs_solrx(), zmat_mgs_solrdx(), zmat_mgs_solrhrx(), zmat_mgs_solrhrdx()</i></span></a>
        </p>
        <p class="Body"><a href="Matrix MGS Decomposition and Condition.htm#mat_mgs_decx" target="" title="" alt="" class="MCXref_See_NoPrefix" MadCap:conditions="Default.ScreenOnly"><span style="color: DarkBlue;" class="mcFormatColor"><i>mat_mgs_decx(), mat_mgs_decdx()</i></span></a>
        </p>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script><iframe id="topiccomments" name="topiccomments" title="Topic Comments" src="../../Skin/TopicComments.htm" frameborder="0" style="width: 100%; height: 0px; margin-top: 12px;"></iframe>
    </body>
</html>