<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="3" MadCap:lastHeight="748" MadCap:lastWidth="654" MadCap:disableMasterStylesheet="true" MadCap:tocPath="" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:liveHelp="EztAWK0e+05oFn6Nq5lqYKtjHH2V8e5IwjAE8Tiij9OvzrJd0fQPwDjHuCqf8R4eRAWyJkCBrbHo/0vwqH4JhzohMfU/ZgPidMUlRIIEQqr3Vq+YXk/EVNBzIGsqkjTwZlAR2M0WNfQ12Sej+bCZsJP/P8HbVIqTfaKxSkacSEXjrS+b88FEbQDVEI3dtbJoeYTJXBO70Jl7rc8tWE37iT+hoShhSWf/1qnW0zxIQEeywMulHUtGmctUr7r3k7D+3tr0FXkvlYE3znvDwZseOrrMlhJxJkpztVMAu9obj+hQ1YTXvm0SEsH1vGOElc9dCAa0NBXBNw+gSvBly+dHUqjV3NiF5wzDNhFtYWVDcQKp64G4wuXKa2a4Um2eT/0lVhw57oCd5I1EdLR0dvWfv8DwjchgpP0vtdAy3U9DBqvtcMiQno5QbXi3HA43Kt1PmLcgNP5rTmMV0dyB2wPLMM4ldfhoMw01FO/j65bMzKSPZYjFvoST7FrzbbDjDTMu0uQ+Sb7RQhyZHksjGvdEAsb5xUkuWUxRox4OYewsx4LFX6TgiTdFdmrjDBvzT6OFwY5M05kPcqCI+YHuxF6Agb/gM8ic1ML8nHEWYKjyyX4OSI2WjvjQmycB7/q+bL+yA54ugIet1WnGqilabYcK/bhqr9Vtf6kc3X7VlZGeeNdDPXS4A5oeG9wXuKmum46Mks5VMTVR88p89vNoxua4IakctdI3ZISvr4hkNhug5/0uu9hRiJsKNplZmkI7t6tydvNaTd+An3/ErjGq5XaSef4vCZB5rRGkV5l13By67vNvNhJRh1XtBABf/8t+K+ruJHPN45LDB+KiKRgYE88ZIHK39b+AI2VyBR6JNPsnaJmf64uchAhIpeQrQRor6fZJP0vj2PaX/QiQ2xG5m+8Ca+8aVsHD56+JtU2RaQ+BClYu6nIRFr0WisKDrto496q+6WZG8oyMPVCez8m4WKAWciLkNQXClaYQ8Krd0WUZZeAWs8OqDUq8Krfs5i1qXOfL" MadCap:PathToHelpSystem="../../" MadCap:HelpSystemFileName="Default.xml" MadCap:SearchType="Stem">
    <head>
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" type="text/css" /><title>Modified Gram-Schmidt QR Decomposition</title>
        <link href="../Resources/TableStyles/o_Note.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/o_Code.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/p_Note.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/p_Code.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/Stylesheets/BookStyles.css" rel="stylesheet" type="text/css" />
        <script src="../SkinSupport/MadCapAll.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapLiveHelpUtilities.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapLiveHelpBody.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapAddCommentDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapReplyCommentDialog.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapRegisterUserDialog.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink" style="display: none;"><a href="../../Default_CSH.htm#AppD - Legacy Functions/Modified Gram-Schmidt.htm" style="">Open topic with navigation</a>
        </p>
        <h2><a name="kanchor1293"></a>Modified Gram-Schmidt QR Decomposition</h2>
        <p class="API_name"><a name="matmgs_dqrx"></a>matmgs_dqrx(), <a name="cmatmgs_dqrx"></a>cmatmgs_dqrx(), <a name="zmatmgs_dqrx"></a>zmatmgs_dqrx()</p>
        <p class="Image">A = QR</p>
        <p class="API_heads">Synopsis</p>
        <table style="width: 500px;caption-side: top;mc-table-style: url('../Resources/TableStyles/o_Code.css');" class="TableStyle_o_Code" cellspacing="0">
            <col style="width: 54px;" />
            <col style="width: 136px;" />
            <col style="width: 310px;" />
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">void <b>matmgs_dqrx</b>(</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_f32 *AT,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* n x m input matrix, A - transpose on input; Q - transpose on exit */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 AT_tcols,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix AT total number of columns */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_f32 *R,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* n x n output matrix R, special format */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 R_tcols,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix R total number of columns */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 m,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix A row count (AT column count) */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 n,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix A column count (AT row count) */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 eflag );</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* ESAL flag */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">void <b>cmatmgs_dqrx</b>(</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_cf32 *AT,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* n x m input matrix, A - transpose on input; Q - transpose on exit */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 AT_tcols,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix AT column element stride */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_cf32 *R,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* n x n output matrix R, special format */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 R_tcols,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix R column element stride */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 m,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix A row count (AT column count) */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 n,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix A column count (AT row count) */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 eflag );</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* ESAL flag */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep" colspan="3">void <b>zmatmgs_dqrx</b>(</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_zf32 *AT,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* n x m input matrix, A - transpose on input; Q - transpose on exit */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 AT_tcols,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix AT column element stride */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_zf32 *R,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* n x n output matrix R, special format */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 R_tcols,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix R column element stride */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 m,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix A row count (AT column count) */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 n,</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* matrix A column count (AT row count) */</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">&#160;</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">SAL_i32 eflag );</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">/* ESAL flag */</td>
            </tr>
        </table>
        <p class="API_heads">Description</p>
        <p class="Body">The matmgs_dqrx(), cmatmgs_dqrx(), and zmatmgs_dqrx() functions decompose matrices. </p>
        <table class="TableStyle_o_Note" style="margin-right: auto;caption-side: top;width: 500px;mc-table-style: url('../Resources/TableStyles/o_Note.css');" cellspacing="0">
            <col style="width: 499px;" />
            <tbody>
                <tr>
                    <td class="TableStyle_o_Note_Body_0_0_RowSep_ColEnd">&#160;</td>
                </tr>
                <tr>
                    <td class="TableStyle_o_Note_Body_0_0_RowEnd_ColEnd">The matmgs_dqrx(), cmatmgs_dqrx(), and zmatmgs_dqrx() functions are not recommended for new application development. Use the <a href="../CH10 - Functions - Matrix Math/Matrix MGS Decomposition and Condition.htm#mat_mgs_decx">mat_mgs_decx</a>(), <a href="../CH10 - Functions - Matrix Math/Matrix MGS Decomposition.htm#cmat_mgs_decx">cmat_mgs_decx</a>(), <a href="../CH10 - Functions - Matrix Math/Matrix MGS Decomposition.htm#zmat_mgs_decx">zmat_mgs_decx</a>() functions for matrix MGS QR decomposition.</td>
                </tr>
            </tbody>
        </table>
        <p class="Body">The decomposition, a thin QR decomposition using the Modified Gram-Schmidt (MGS) method, is a factorization of an <i>m </i>x <i>n </i>matrix <i>A</i>, with <i>m </i>greater than or equal to <i>n</i>, into an <i>m </i>x <i>n </i>matrix <i>Q</i>, with orthonormal columns, multiplied by upper triangular matrix <i>R</i>.</p>
        <p class="Body">The <i>n </i>x <i>m </i>input matrix, <i>AT</i>, is the transpose of an <i>m </i>x <i>n </i>matrix <i>A</i>, with <i>m </i>greater than or equal to <i>n </i>and full column rank. On exit, the input storage location contains an <i>n </i>x <i>m </i>matrix <i>QT</i>, with orthonormal columns.</p>
        <p class="Body">The <i>AT_tcols </i>parameter is the matrix <i>AT </i>column element stride.</p>
        <p class="Body">The <i>R </i>output matrix is stored in a special format. Each diagonal element is replaced by its reciprocal. The zeros below the diagonal are replaced by the corresponding elements above the diagonal, making the <i>R </i>matrix symmetric.</p>
        <p class="Body">For example, if <i>n </i>= 4, the theoretical <i>R </i>matrix is:</p>
        <table style="mc-table-style: url('../Resources/TableStyles/o_Code.css');width: 192px;" class="TableStyle_o_Code">
            <col />
            <col />
            <col />
            <col />
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r00</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r01</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r02</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">r03</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">0</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r11</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r12</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">r13</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">0</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">0</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r22</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">r23</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">0</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">0</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">0</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">r33</td>
            </tr>
        </table>
        <p class="Body">The corresponding 4 x 4 matrix in special <i>R </i>matrix format is:</p>
        <table style="mc-table-style: url('../Resources/TableStyles/o_Code.css');width: 191px;" class="TableStyle_o_Code">
            <col />
            <col />
            <col />
            <col />
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">1/r00</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r01</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r02</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">r03</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r01</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">1/r11</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r12</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">r13</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r02</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r12</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">1/r22</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">r23</td>
            </tr>
            <tr>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r03</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r13</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColSep">r23</td>
                <td class="TableStyle_o_Code_Body_0_0_RowSep_ColEnd">1/r33</td>
            </tr>
        </table>
        <p class="Body">The <i>R_tcols </i>parameter is the matrix <i>R </i>column element stride. </p>
        <p class="Body">The <i>m </i>parameter is the matrix <i>A </i>row count, equal to the matrix <i>AT </i>column count.</p>
        <p class="Body">The <i>n </i>parameter is the matrix <i>A </i>column count, equal to the matrix <i>AT </i>row count.</p>
        <p class="Body">These decomposition functions perform a complete MGS QR decomposition in a single call for use in a single processor application. They are designed to use with the MGS QR solution functions matmgs_srx(), matmgs_srhrx(), cmatmgs_srx(), cmatmgs_srhrx(), zmatmgs_srx(), and zmatmgs_srhrx().</p>
        <p class="Body">For applications using multiple processors, use the appropriate matmgs_dkerx(), matmgs_dkerx(), or matmgs_dkerx() MGS QR decomposition kernel function to perform single stages of the decomposition.</p>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script><iframe id="topiccomments" name="topiccomments" title="Topic Comments" src="../../Skin/TopicComments.htm" frameborder="0" style="width: 100%; height: 0px; margin-top: 12px;"></iframe>
    </body>
</html>